(function(r){function m(a,b,c){return a.substr(0,c)+b+a.substr(c+b.length)}"use strict";var p="|",l={vers:function(){return"1.1.1"},abs:Math.abs,exp:Math.exp,"int":Math.trunc,log:Math.log,log2:Math.log2,log10:Math.log10,pow:Math.pow,round:Math.round,sqrt:Math.sqrt,add:function(a,b){return a+b},sub:function(a,b){return a-b},mul:function(a,b){return a*b},div:function(a,b){return a/b},mod:function(a,b){return a%b},sqr:function(a){return a*a},eq:function(a,b){return a==b?1:0},neq:function(a,b){return a!=
b?1:0},lt:function(a,b){return a<b?1:0},le:function(a,b){return a<=b?1:0},gt:function(a,b){return a>b?1:0},ge:function(a,b){return a>=b?1:0},not:function(a){return a?0:1},pop:function(a){},plural:function(a){return 1<a?1:0},str:function(a){return a.toString()},strb:function(a,b){return a.toString(b)},subs:function(a,b,c){return a.substr(b,c)},lc:function(a){return a.toLowerCase()},uc:function(a){return a.toUpperCase()},cap:function(a){return a.replace(/(\s|^)([a-z])/g,function(a){return a.toUpperCase()})},
json:function(a){return JSON.stringify(a)},num:function(a){return+a},nan:function(a){return isNaN(a)},dtor:function(a){return a*Math.PI/180},rtod:function(a){return 180*a/Math.PI},mstod:function(a){return new Date(a)},dtoms:function(a){return Date.parse(a).valueOf()},now:function(){return new Date},"float":function(a){return parseFloat(a)},length:function(a,b){return Math.sqrt(a*a+b*b)},loc:function(a){return a.toLocaleString()},prec:function(a,b){return a.toPrecision(b)},fix:function(a,b){return a.toFixed(b)},
fract:function(a){return a-Math.trunc(a)},mins:function(a){return Math.floor(60*a)%60},secs:function(a){return Math.floor(3600*a)%60},sign:function(a){return Math.sign(a)},clip:function(a,b){return a<b[0]?b[0]:a>b[1]?b[1]:a},wrap:function(a,b){for(var c=b[1]-b[0];a<b[0];)a+=c;for(;a>b[1];)a-=c;return a},rep:function(a,b){return Array(b).fill(a).join("")},at:function(a,b){return a[b]},right:function(a,b){return(""+b+a).slice(-b.length)},left:function(a,b){return(""+a+b).slice(0,b.length)},ral:function(a,
b,c){b=b.toString();return m(a,b,c-b.length)},lal:function(a,b,c){return m(a,b.toString(),c)},sal:function(a,b,c,f){b=b.toString();c=b.indexOf(c);f-=0<=c?c:b.length;return m(a,b,f)},cal:function(a,b,c){b=b.toString();return m(a,b,c-(b.length>>1))},deco:function(a){return decodeURI(a)},pi:function(){return Math.PI},e:function(){return Math.E},lfld:function(a,b){return h("lfld")(a,b)},rfld:function(a,b){return h("rfld")(a,b)},dms:function(a){return h("dms")(a)},lat:function(a){return h("lat")(a)},lon:function(a){return h("lon")(a)},
latlon:function(a){return h("latlon")(a)}},q={add:"+",sub:"-",mul:"*",div:"/",mod:"%",eq:"==",ne:"!=",lt:"<",le:"<=",gt:">",ge:">=",pi:"\u03c0"};Object.keys(q).forEach(function(a,b){l[q[a]]=l[a]});var h=function(a){var b={};return function(c){var f=b[c];f||(b[c]=f=g(a[c]));return f}}({lfld:"$n_|$$x_|& |$n_|_rep|_left|>>",rfld:"$n_|$$x_|& |$n_|_rep|_right|>>",dms:"$$d_|_int|>>|\u00b0|$d_|_mins|&00|_right|>>|'|$d_|_secs|&00|_right|>>|\"",lat:"$$lat_|_abs|$$ad_|_int|@[-90,90]|_clip|&  |_right|>>|\u00b0|$ad_|_mins|&00|_right|>>|'|$ad_|_secs|&00|_right|>>|\"|$lat_|_sign|#1|_add|S:: ::N",
lon:"$$lon_|_abs|$$ad_|_int|@[-180,180]|_wrap|&   |_right|>>|\u00b0|$ad_|_mins|&00|_right|>>|'|$ad_|_secs|&00|_right|>>|\"|$lon_|_sign|#1|_add|W:: ::E",latlon:"$$ll_|#0|_at|_lat|>>|, |$ll_|#1|_at|_lon|>>",error:'&ERROR: function "|>>|$msg_|>>|&" not available!|>>'}),g=function(a){function b(a,b){if(void 0!==b)return new Function(b,"return "+a);var c=new Function("return "+a),d=c();return d instanceof Function?d:c}function c(){var c=a.split(p);p="|";return c.map(function(a){var c;switch(a.charAt(0)){case "$":c=
"$"===a[1]?"nam":"var";a="$"===a[1]?a.substr(1):a;c={type:c,name:a};var d=a.indexOf("."),n=a.indexOf("[");if(0<d||0<n)c.name=a.substr(0,Math.min(0>d?n:d,0>n?d:n)),c.expr=b(a,c.name);break;case "#":c=parseFloat(a.substr(1));c={type:"num",value:isNaN(c)?b(a.substr(1)):c};break;case "&":c={type:"str",value:a.substr(1)};break;case "@":c={type:"jsn",value:JSON.parse(a.substr(1))};break;case "_":c={type:"fun",fun:a.substr(1)};break;case ">":c={type:"out"};break;case "%":c={type:"com",text:a.substr(1)};
break;default:a="\\"===a.charAt(0)?a.substr(1):a,c={type:"lab",labs:a.split("::")}}return c})}var f=[];a&&(f=c());var g=function(){var a=Array.prototype.slice.call(arguments),c=[],k={},d;g.getValue=function(a){return k[a]};a.forEach(function(a){if(a.key&&"$"===a.key.charAt(0))k[a.key]=a.value;else if((d=Object.keys(a))&&1===d.length&&"$"===d[0].charAt(0)){var b=d[0];k[b]=a[b]}else c.push(a)});return f.reduce(function(a,e,d){d="";switch(e.type){case "var":if(void 0!==k[e.name]){var f=k[e.name];c.push(e.expr?
e.expr(f):f)}else k[e.name]=c.pop();break;case "nam":k[e.name]=c[c.length-1];break;case "num":case "str":case "jsn":c.push(e.value);break;case "fun":if(f=l[e.fun]||b(e.fun))e=f.length,e=f.apply(f,0==e?null:c.splice(-e)),void 0!==e&&c.push(e);else throw h("error")(e.fun);break;case "out":d=c.pop();d=void 0===d?"":d;break;case "lab":d=1<e.labs.length?e.labs[c.pop()]:e.labs[0]}return a+d},"")};return g};g.setSeparator=function(a){p=a};g.setFunction=function(a,b){l[a.substr(1)]=b};g.testFunction=function(a){var b=
Array.prototype.slice.call(arguments),c=l[a.substr(1)];if(c)return c.apply(c,b.splice(1-b.length));console.error(h("error")(ll)(a))};"undefined"!==typeof exports?exports.formatX=g:r.formatX=g})("undefined"===typeof window?global:window);